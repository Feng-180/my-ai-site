<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI åŠ©æ‰‹</title>
    <style>
        /* è¿™é‡Œæ˜¯æ ·å¼ (CSS) */
        body { margin: 0; padding: 0; font-family: sans-serif; background-color: #1a1a1a; color: #fff; display: flex; justify-content: center; height: 100vh; }
        .app { width: 100%; max-width: 800px; display: flex; flex-direction: column; background: #2d2d2d; height: 100%; }
        .header { padding: 15px; border-bottom: 1px solid #444; text-align: center; font-weight: bold; background: #202020; }
        .chat-box { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        .msg { display: flex; gap: 10px; max-width: 85%; }
        .msg.user { align-self: flex-end; flex-direction: row-reverse; }
        .bubble { padding: 10px 14px; border-radius: 12px; line-height: 1.5; word-wrap: break-word; }
        .msg.user .bubble { background: #4caf50; color: #fff; }
        .msg.ai .bubble { background: #444; color: #e0e0e0; }
        .input-area { padding: 15px; background: #202020; border-top: 1px solid #444; display: flex; flex-direction: column; gap: 10px; }
        input, textarea { background: #333; border: 1px solid #555; color: #fff; padding: 10px; border-radius: 5px; outline: none; }
        button { background: #4caf50; color: white; border: none; padding: 10px; border-radius: 5px; font-weight: bold; cursor: pointer; }
        button:disabled { background: #555; }
    </style>
</head>
<body>

<div class="app">
    <div class="header">ğŸ”® æ™ºèƒ½ AI åŠ©æ‰‹</div>
    
    <div class="chat-box" id="chat-box">
        <div class="msg ai">
            <div class="bubble">ä½ å¥½ï¼è¯·å…ˆåœ¨ä¸‹æ–¹å¡«å…¥ä½ çš„ API Keyï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å¼€å§‹èŠå¤©ã€‚</div>
        </div>
    </div>

    <div class="input-area">
        <input type="password" id="api-key" placeholder="ç²˜è´´ä½ çš„ OpenRouter Key (sk-or-...)">
        <textarea id="user-input" rows="1" placeholder="è¯´ç‚¹ä»€ä¹ˆ..."></textarea>
        <button id="send-btn" onclick="runChat()">å‘é€</button>
    </div>
</div>

<script>
    // è¿™é‡Œæ˜¯é€»è¾‘ (JS)
    // å¼ºåˆ¶æ£€æŸ¥ï¼šå¦‚æœä»£ç è¢«é”™è¯¯ç¬¦å·å¹²æ‰°ï¼Œè¿™é‡Œä¼šæŠ¥é”™ï¼Œä½†æ•´åˆåœ¨ä¸€èµ·æ›´ç¨³å®šã€‚
    
    async function runChat() {
        const keyInput = document.getElementById('api-key');
        const textInput = document.getElementById('user-input');
        const chatBox = document.getElementById('chat-box');
        const btn = document.getElementById('send-btn');

        const key = keyInput.value.trim();
        const text = textInput.value.trim();

        if (!key) { alert("è¯·å…ˆå¡«å†™ API Keyï¼"); return; }
        if (!text) return;

        // 1. æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
        addBubble('user', text);
        textInput.value = '';
        btn.disabled = true;
        btn.innerText = "æ€è€ƒä¸­...";

        // 2. å‘é€è¯·æ±‚
        try {
            const req = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Authorization": "Bearer " + key,
                    "Content-Type": "application/json",
                    "HTTP-Referer": window.location.href,
                    "X-Title": "My AI Site"
                },
                body: JSON.stringify({
                    model: "nousresearch/hermes-3-llama-3.1-405b",
                    messages: [
                        { role: "system", content: "ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„ä¸­æ–‡AIåŠ©æ‰‹ã€‚" },
                        { role: "user", content: text }
                    ]
                })
            });

            if (!req.ok) throw new Error("è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ Key");
            
            const res = await req.json();
            const reply = res.choices[0].message.content;
            
            // 3. æ˜¾ç¤º AI å›å¤
            addBubble('ai', reply);

        } catch (err) {
            addBubble('ai', "âŒ å‡ºé”™: " + err.message);
        } finally {
            btn.disabled = false;
            btn.innerText = "å‘é€";
        }
    }

    function addBubble(role, text) {
        const box = document.getElementById('chat-box');
        const div = document.createElement('div');
        div.className = 'msg ' + role;
        div.innerHTML = '<div class="bubble">' + text + '</div>';
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
    }
</script>

</body>
</html>